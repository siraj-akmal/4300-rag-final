"$year"}, "Avg Rating": {"$avg": "$imdb.rating"}}}, {"$sort" : {"Avg Rating": -1, "_id": 1}} ]) print(dumps(c, indent = 2)) Lookup data = demodb.customers.aggregate([ { "$lookup": { "from": "orders", "localField": "custid", "foreignField": "custid", "as": "orders" } }, {"$project": {"_id": 0, "address": 0}} ]) print(dumps(data, indent = 2)) Reformatting Queries match = {"$match": {"year":